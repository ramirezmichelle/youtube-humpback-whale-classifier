
Num GPUs available:  4
2022-07-16 14:31:39.321135: I tensorflow/core/platform/cpu_feature_guard.cc:152] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-07-16 14:31:42.618109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14649 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB-N, pci bus id: 0000:85:00.0, compute capability: 7.0
2022-07-16 14:31:42.620263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 14649 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB-N, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-07-16 14:31:42.622254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 14649 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB-N, pci bus id: 0000:89:00.0, compute capability: 7.0
2022-07-16 14:31:42.624235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 14649 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB-N, pci bus id: 0000:8a:00.0, compute capability: 7.0
INFO:tensorflow:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1', '/job:localhost/replica:0/task:0/device:GPU:2', '/job:localhost/replica:0/task:0/device:GPU:3')
Number of devices: 4
WARNING:tensorflow:Using MirroredStrategy eagerly has significant overhead currently. We will be working on improving this in the future, but for now please wrap `call_for_each_replica` or `experimental_run` or `run` inside a tf.function to get the best performance.
video_0000.mp4
2022-07-16 14:31:49.005872: W tensorflow/core/grappler/optimizers/data/auto_shard.cc:776] AUTO sharding policy will apply DATA sharding policy as it failed to apply FILE sharding policy because of the following reason: Found an unshardable source dataset: name: "TensorSliceDataset/_1"
op: "TensorSliceDataset"
input: "Placeholder/_0"
attr {
  key: "Toutput_types"
  value {
    list {
      type: DT_STRING
    }
  }
}
attr {
  key: "_cardinality"
  value {
    i: 364
  }
}
attr {
  key: "is_files"
  value {
    b: false
  }
}
attr {
  key: "metadata"
  value {
    s: "\n\024TensorSliceDataset:0"
  }
}
attr {
  key: "output_shapes"
  value {
    list {
      shape {
      }
    }
  }
}
experimental_type {
  type_id: TFT_PRODUCT
  args {
    type_id: TFT_DATASET
    args {
      type_id: TFT_PRODUCT
      args {
        type_id: TFT_TENSOR
        args {
          type_id: TFT_STRING
        }
      }
    }
  }
  args {
    type_id: TFT_DATASET
    args {
      type_id: TFT_PRODUCT
      args {
        type_id: TFT_TENSOR
        args {
          type_id: TFT_STRING
        }
      }
    }
  }
}
2022-07-16 14:32:58.337325: I tensorflow/stream_executor/cuda/cuda_dnn.cc:379] Loaded cuDNN version 8400
video_0060.mp4
video_0122.mp4
2022-07-16 16:13:21.668397: I tensorflow/stream_executor/cuda/cuda_dnn.cc:379] Loaded cuDNN version 8400
video_0178.mp4
video_0227.mp4
2022-07-16 17:52:49.741840: I tensorflow/stream_executor/cuda/cuda_dnn.cc:379] Loaded cuDNN version 8400
video_0282.mp4
video_0329.mp4
2022-07-16 19:23:23.383279: I tensorflow/stream_executor/cuda/cuda_dnn.cc:379] Loaded cuDNN version 8400
video_0382.mp4
Done extracting features.
(364, 461, 2048)
['video_0000.mp4', 'video_0001.mp4', 'video_0002.mp4', 'video_0003.mp4', 'video_0004.mp4', 'video_0006.mp4', 'video_0007.mp4', 'video_0008.mp4', 'video_0009.mp4', 'video_0010.mp4', 'video_0011.mp4', 'video_0014.mp4', 'video_0017.mp4', 'video_0018.mp4', 'video_0019.mp4', 'video_0020.mp4', 'video_0021.mp4', 'video_0023.mp4', 'video_0024.mp4', 'video_0025.mp4', 'video_0026.mp4', 'video_0027.mp4', 'video_0028.mp4', 'video_0029.mp4', 'video_0030.mp4', 'video_0031.mp4', 'video_0032.mp4', 'video_0033.mp4', 'video_0034.mp4', 'video_0035.mp4', 'video_0036.mp4', 'video_0037.mp4', 'video_0039.mp4', 'video_0040.mp4', 'video_0041.mp4', 'video_0042.mp4', 'video_0043.mp4', 'video_0044.mp4', 'video_0046.mp4', 'video_0047.mp4', 'video_0048.mp4', 'video_0049.mp4', 'video_0050.mp4', 'video_0051.mp4', 'video_0052.mp4', 'video_0053.mp4', 'video_0054.mp4', 'video_0055.mp4', 'video_0057.mp4', 'video_0058.mp4', 'video_0060.mp4', 'video_0061.mp4', 'video_0065.mp4', 'video_0066.mp4', 'video_0067.mp4', 'video_0068.mp4', 'video_0070.mp4', 'video_0071.mp4', 'video_0072.mp4', 'video_0075.mp4', 'video_0078.mp4', 'video_0079.mp4', 'video_0080.mp4', 'video_0083.mp4', 'video_0084.mp4', 'video_0085.mp4', 'video_0088.mp4', 'video_0089.mp4', 'video_0090.mp4', 'video_0091.mp4', 'video_0092.mp4', 'video_0094.mp4', 'video_0095.mp4', 'video_0096.mp4', 'video_0098.mp4', 'video_0099.mp4', 'video_0100.mp4', 'video_0103.mp4', 'video_0105.mp4', 'video_0106.mp4', 'video_0107.mp4', 'video_0108.mp4', 'video_0110.mp4', 'video_0111.mp4', 'video_0112.mp4', 'video_0113.mp4', 'video_0116.mp4', 'video_0117.mp4', 'video_0118.mp4', 'video_0119.mp4', 'video_0121.mp4']
['video_0122.mp4', 'video_0123.mp4', 'video_0126.mp4', 'video_0127.mp4', 'video_0128.mp4', 'video_0129.mp4', 'video_0131.mp4', 'video_0132.mp4', 'video_0133.mp4', 'video_0134.mp4', 'video_0135.mp4', 'video_0136.mp4', 'video_0137.mp4', 'video_0138.mp4', 'video_0139.mp4', 'video_0140.mp4', 'video_0141.mp4', 'video_0142.mp4', 'video_0143.mp4', 'video_0144.mp4', 'video_0145.mp4', 'video_0146.mp4', 'video_0147.mp4', 'video_0148.mp4', 'video_0150.mp4', 'video_0151.mp4', 'video_0152.mp4', 'video_0153.mp4', 'video_0154.mp4', 'video_0155.mp4', 'video_0156.mp4', 'video_0158.mp4', 'video_0159.mp4', 'video_0161.mp4', 'video_0162.mp4', 'video_0163.mp4', 'video_0164.mp4', 'video_0165.mp4', 'video_0166.mp4', 'video_0167.mp4', 'video_0168.mp4', 'video_0169.mp4', 'video_0170.mp4', 'video_0171.mp4', 'video_0172.mp4', 'video_0173.mp4', 'video_0174.mp4', 'video_0175.mp4', 'video_0176.mp4', 'video_0177.mp4', 'video_0178.mp4', 'video_0180.mp4', 'video_0181.mp4', 'video_0182.mp4', 'video_0183.mp4', 'video_0184.mp4', 'video_0185.mp4', 'video_0186.mp4', 'video_0188.mp4', 'video_0189.mp4', 'video_0190.mp4', 'video_0191.mp4', 'video_0192.mp4', 'video_0194.mp4', 'video_0195.mp4', 'video_0196.mp4', 'video_0197.mp4', 'video_0198.mp4', 'video_0199.mp4', 'video_0200.mp4', 'video_0202.mp4', 'video_0203.mp4', 'video_0204.mp4', 'video_0205.mp4', 'video_0207.mp4', 'video_0208.mp4', 'video_0209.mp4', 'video_0210.mp4', 'video_0211.mp4', 'video_0214.mp4', 'video_0216.mp4', 'video_0217.mp4', 'video_0218.mp4', 'video_0219.mp4', 'video_0220.mp4', 'video_0221.mp4', 'video_0222.mp4', 'video_0223.mp4', 'video_0224.mp4', 'video_0225.mp4', 'video_0226.mp4']
['video_0227.mp4', 'video_0228.mp4', 'video_0229.mp4', 'video_0230.mp4', 'video_0231.mp4', 'video_0233.mp4', 'video_0234.mp4', 'video_0236.mp4', 'video_0237.mp4', 'video_0239.mp4', 'video_0240.mp4', 'video_0241.mp4', 'video_0242.mp4', 'video_0243.mp4', 'video_0244.mp4', 'video_0245.mp4', 'video_0246.mp4', 'video_0247.mp4', 'video_0248.mp4', 'video_0249.mp4', 'video_0250.mp4', 'video_0251.mp4', 'video_0252.mp4', 'video_0253.mp4', 'video_0254.mp4', 'video_0255.mp4', 'video_0256.mp4', 'video_0257.mp4', 'video_0258.mp4', 'video_0260.mp4', 'video_0261.mp4', 'video_0262.mp4', 'video_0263.mp4', 'video_0264.mp4', 'video_0265.mp4', 'video_0266.mp4', 'video_0267.mp4', 'video_0268.mp4', 'video_0269.mp4', 'video_0270.mp4', 'video_0271.mp4', 'video_0272.mp4', 'video_0273.mp4', 'video_0274.mp4', 'video_0275.mp4', 'video_0276.mp4', 'video_0277.mp4', 'video_0279.mp4', 'video_0280.mp4', 'video_0281.mp4', 'video_0282.mp4', 'video_0283.mp4', 'video_0284.mp4', 'video_0285.mp4', 'video_0286.mp4', 'video_0287.mp4', 'video_0290.mp4', 'video_0291.mp4', 'video_0292.mp4', 'video_0293.mp4', 'video_0294.mp4', 'video_0295.mp4', 'video_0296.mp4', 'video_0297.mp4', 'video_0299.mp4', 'video_0300.mp4', 'video_0301.mp4', 'video_0302.mp4', 'video_0303.mp4', 'video_0304.mp4', 'video_0305.mp4', 'video_0307.mp4', 'video_0308.mp4', 'video_0309.mp4', 'video_0310.mp4', 'video_0311.mp4', 'video_0312.mp4', 'video_0313.mp4', 'video_0314.mp4', 'video_0315.mp4', 'video_0317.mp4', 'video_0318.mp4', 'video_0319.mp4', 'video_0320.mp4', 'video_0321.mp4', 'video_0323.mp4', 'video_0324.mp4', 'video_0325.mp4', 'video_0326.mp4', 'video_0327.mp4', 'video_0328.mp4']
