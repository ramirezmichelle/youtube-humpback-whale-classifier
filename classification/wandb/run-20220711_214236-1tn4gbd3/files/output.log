
Num GPUs available:  2
2022-07-11 21:42:44.093439: I tensorflow/core/platform/cpu_feature_guard.cc:152] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-07-11 21:42:46.147512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14649 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB-N, pci bus id: 0000:06:00.0, compute capability: 7.0
2022-07-11 21:42:46.151160: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 14649 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB-N, pci bus id: 0000:0b:00.0, compute capability: 7.0
/device:GPU:0
/device:GPU:1
/device:GPU:0
/device:GPU:1
video_0000.mp4
2022-07-11 21:43:32.420158: I tensorflow/stream_executor/cuda/cuda_dnn.cc:379] Loaded cuDNN version 8400
video_0134.mp4
video_0248.mp4
video_0357.mp4
Time to extract frames with single GPU: 18351.396564483643s
Frame features shape:  (364, 461, 2048)
Frame masks shape:  (364, 461)
Number of Labels:  364
Fold 0
3/3 [==============================] - 0s 31ms/step - loss: 0.6074 - accuracy: 0.7260
Fold 1
3/3 [==============================] - 0s 31ms/step - loss: 0.6143 - accuracy: 0.7397
Fold 2
3/3 [==============================] - 0s 28ms/step - loss: 0.5738 - accuracy: 0.7123
Fold 3
3/3 [==============================] - 0s 34ms/step - loss: 0.6128 - accuracy: 0.7123
Fold 4
3/3 [==============================] - 0s 33ms/step - loss: 0.5561 - accuracy: 0.8056
291 73
291 73
291 73
291 73
291 73
292 72
292 72
3/3 [==============================] - 0s 34ms/step - loss: 0.6276 - accuracy: 0.6438
Loss: 0.6275607943534851, Accuracy: 0.6438356041908264
3/3 [==============================] - 0s 32ms/step - loss: 0.5910 - accuracy: 0.6849
Loss: 0.5910294651985168, Accuracy: 0.6849315166473389
3/3 [==============================] - 0s 38ms/step - loss: 0.6388 - accuracy: 0.7123
Loss: 0.6387816667556763, Accuracy: 0.7123287916183472
F1: [0.75862069 0.6440678 ], Precision: [0.67346939 0.79166667], Recall: [0.86842105 0.54285714]