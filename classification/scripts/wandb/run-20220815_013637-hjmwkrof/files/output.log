Memory growth is now the same across all 8 available GPUs.
Loading data...
Video 0 ...
Video 50 ...
Video 100 ...
Video 150 ...
Video 200 ...
Video 250 ...
Video 300 ...
Video 350 ...
Done loading videos in 4340.170624017715 seconds.
Setting TensorFlow Mirrored Strategy with 4 GPUs...
Number of devices in strategy: 4
Creating TF Dataset...
Creating TF DISTRIBUTED Dataset...
Creating CNN Model on Each Active Replica (GPU)
Beginning Feature Extraction in GPU Mode...
Done getting video frame feature representations in 49.864651918411255 seconds.
Formatting Results into Numpy Arrays...
Setting TensorFlow Mirrored Strategy with 4 GPUs...
Number of devices in strategy: 4
Creating TF Dataset...
Creating TF DISTRIBUTED Dataset...
Creating CNN Model on Each Active Replica (GPU)
Beginning Feature Extraction in GPU Mode...
Done getting video frame feature representations in 22.840184926986694 seconds.
Formatting Results into Numpy Arrays...
Setting TensorFlow Mirrored Strategy with 4 GPUs...
Number of devices in strategy: 4
Creating TF Dataset...
Creating TF DISTRIBUTED Dataset...
Creating CNN Model on Each Active Replica (GPU)
Beginning Feature Extraction in GPU Mode...
Done getting video frame feature representations in 21.9367458820343 seconds.
Formatting Results into Numpy Arrays...
Back from feature Extraction.
Train Features: (232, 461, 2048) || Train Labels: (232, 1)
Val Features: (59, 461, 2048) || Val Labels: (59, 1)
Test Features: (73, 461, 2048) || Test Labels: (73, 1)
Epoch 1/15

8/8 [==============================] - 13s 650ms/step - loss: 0.6750 - accuracy: 0.6595 - val_loss: 0.5759 - val_accuracy: 0.6610
Epoch 2/15

8/8 [==============================] - 3s 347ms/step - loss: 0.4070 - accuracy: 0.8017 - val_loss: 0.5056 - val_accuracy: 0.8136
Epoch 3/15

8/8 [==============================] - 3s 342ms/step - loss: 0.3315 - accuracy: 0.8621 - val_loss: 0.4386 - val_accuracy: 0.7797
Epoch 4/15

8/8 [==============================] - 3s 345ms/step - loss: 0.2370 - accuracy: 0.9181 - val_loss: 0.4794 - val_accuracy: 0.7797
Epoch 5/15
8/8 [==============================] - 3s 343ms/step - loss: 0.1563 - accuracy: 0.9397 - val_loss: 0.4932 - val_accuracy: 0.7966
Epoch 6/15
8/8 [==============================] - 3s 344ms/step - loss: 0.1345 - accuracy: 0.9526 - val_loss: 1.1092 - val_accuracy: 0.6610
Epoch 7/15

8/8 [==============================] - 3s 344ms/step - loss: 0.1559 - accuracy: 0.9181 - val_loss: 0.4242 - val_accuracy: 0.8475
Epoch 8/15

8/8 [==============================] - 3s 342ms/step - loss: 0.0846 - accuracy: 0.9741 - val_loss: 0.6053 - val_accuracy: 0.7966
Epoch 9/15

8/8 [==============================] - 3s 345ms/step - loss: 0.1200 - accuracy: 0.9483 - val_loss: 0.5049 - val_accuracy: 0.7966
Epoch 10/15

8/8 [==============================] - 3s 344ms/step - loss: 0.1616 - accuracy: 0.9353 - val_loss: 0.6542 - val_accuracy: 0.7966
Epoch 11/15
8/8 [==============================] - 3s 344ms/step - loss: 0.1265 - accuracy: 0.9741 - val_loss: 0.5252 - val_accuracy: 0.7627
Epoch 12/15

8/8 [==============================] - 3s 346ms/step - loss: 0.0492 - accuracy: 0.9914 - val_loss: 0.6737 - val_accuracy: 0.7458
3/3 [==============================] - 1s 83ms/step - loss: 0.5830 - accuracy: 0.7945
              File  True Relevant Label  Pred Relevant Label
0   video_0241.mp4                False                False
1   video_0040.mp4                 True                 True
2   video_0020.mp4                 True                 True
3   video_0410.mp4                False                False
4   video_0071.mp4                 True                 True
..             ...                  ...                  ...
68  video_0250.mp4                False                False
69  video_0110.mp4                 True                 True
70  video_0127.mp4                False                False
71  video_0240.mp4                False                False
72  video_0363.mp4                 True                 True
[73 rows x 3 columns]
              File  True Relevant Label  Pred Relevant Label                                         video_clip
16  video_0000.mp4                 True                False  <wandb.sdk.data_types.video.Video object at 0x...
              File  True Relevant Label  Pred Relevant Label                                         video_clip
11  video_0047.mp4                False                 True  <wandb.sdk.data_types.video.Video object at 0x...
17  video_0274.mp4                False                 True  <wandb.sdk.data_types.video.Video object at 0x...
20  video_0010.mp4                False                 True  <wandb.sdk.data_types.video.Video object at 0x...
22  video_0095.mp4                False                 True  <wandb.sdk.data_types.video.Video object at 0x...
26  video_0268.mp4                False                 True  <wandb.sdk.data_types.video.Video object at 0x...
41  video_0301.mp4                False                 True  <wandb.sdk.data_types.video.Video object at 0x...
45  video_0283.mp4                False                 True  <wandb.sdk.data_types.video.Video object at 0x...
52  video_0338.mp4                False                 True  <wandb.sdk.data_types.video.Video object at 0x...
53  video_0407.mp4                False                 True  <wandb.sdk.data_types.video.Video object at 0x...
54  video_0221.mp4                False                 True  <wandb.sdk.data_types.video.Video object at 0x...
55  video_0398.mp4                False                 True  <wandb.sdk.data_types.video.Video object at 0x...
60  video_0347.mp4                False                 True  <wandb.sdk.data_types.video.Video object at 0x...
61  video_0309.mp4                False                 True  <wandb.sdk.data_types.video.Video object at 0x...
66  video_0272.mp4                False                 True  <wandb.sdk.data_types.video.Video object at 0x...
CNN         Accuracy (Test)    Loss (Test)    F1 Score    Time to Extract Features (sec)    Videos/Second (Feat. Ext.)    Frames/Second (Feat. Ext.)
--------  -----------------  -------------  ----------  --------------------------------  ----------------------------  ----------------------------
resnet50           0.794521       0.583045    0.819277                           72.7048                       4.00248                       1845.15